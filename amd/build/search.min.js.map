{"version":3,"file":"search.min.js","sources":["../src/search.js"],"sourcesContent":["const IDENTIFIERS = {\n    SEARCHINPUT: 'downloadcenter-search-input',\n    FORM: '#region-main form.mform',\n    FORMELEMENTS: '.fitem',\n    TOPICS: '.card.block',\n    CHECKBOX: 'input[type=\"checkbox\"]',\n    TITLE: 'label .itemtitle span:not(.badge)',\n    RESULTSHOLDER: 'downloadcenter-search-results',\n    RESULTSCOUNT: 'downloadcenter-search-results-count',\n    SEARCHCLEAR: '#downloadcenter-search-clear'\n};\n\nconst allCmsPerTopic = [];\nlet resultsHolder = null;\nlet resultsCount = null;\nlet searchClearBtn = null;\nlet searchInput = null;\n\n\nconst search = (searchValue) => {\n    const showAll = searchValue.length === 0;\n    let resultscount = 0;\n    allCmsPerTopic.forEach(topic => {\n        let foundInTopic = false;\n        topic.cms.forEach(cm => {\n            if (cm.title.indexOf(searchValue) > -1 || showAll) {\n                foundInTopic = true;\n                resultscount++;\n                cm.visible = true;\n                cm.elem.classList.remove('d-none');\n            } else {\n                cm.visible = false;\n                cm.elem.classList.add('d-none');\n            }\n        });\n        if (foundInTopic) {\n            topic.visible = true;\n            topic.elem.classList.remove('d-none');\n        } else {\n            topic.visible = false;\n            topic.elem.classList.add('d-none');\n        }\n    });\n    if (!showAll) {\n        resultsCount.textContent = resultscount;\n        resultsHolder.classList.remove('d-none');\n        searchClearBtn.classList.remove('d-none');\n    } else {\n        resultsHolder.classList.add('d-none');\n        searchClearBtn.classList.add('d-none');\n    }\n};\n\nconst searchClear = (e) => {\n    e.preventDefault();\n    searchInput.value = '';\n    search('');\n};\n\nconst submitForm = () => {\n    // We need to make sure that if a topic or a cm is not visible, it's checkbox is not checked.\n    allCmsPerTopic.forEach(topic => {\n        if (!topic.visible && topic.checkbox.checked) {\n            topic.checkbox.checked = false;\n        }\n        topic.cms.forEach(cm => {\n            if (!cm.visible && cm.checkbox.checked) {\n                cm.checkbox.checked = false;\n            }\n        });\n    });\n    return true;\n};\n\nexport const init = () => {\n    searchInput = document.getElementById(IDENTIFIERS.SEARCHINPUT);\n    searchInput.addEventListener('input', (e) => { search(e.target.value.toLowerCase()); });\n    const form = document.querySelector(IDENTIFIERS.FORM);\n    const topics = form.querySelectorAll(IDENTIFIERS.TOPICS);\n    resultsHolder = document.getElementById(IDENTIFIERS.RESULTSHOLDER);\n    resultsCount = document.getElementById(IDENTIFIERS.RESULTSCOUNT);\n    searchClearBtn = document.querySelector(IDENTIFIERS.SEARCHCLEAR);\n    searchClearBtn.addEventListener('click', searchClear);\n\n    form.addEventListener('submit', submitForm);\n    topics.forEach(topic => {\n        const elements = topic.querySelectorAll(IDENTIFIERS.FORMELEMENTS);\n        const topicObj = {};\n        topicObj.elem = topic;\n        topicObj.cms = [];\n        topicObj.visible = true;\n        topicObj.checkbox = topic.querySelector(IDENTIFIERS.CHECKBOX);\n        elements.forEach(element => {\n            const title = element.querySelector(IDENTIFIERS.TITLE);\n            if (title) {\n                const cmObj = {};\n                cmObj.title = title.textContent.toLowerCase();\n                cmObj.elem = element;\n                cmObj.visible = true;\n                cmObj.checkbox = element.querySelector(IDENTIFIERS.CHECKBOX);\n                topicObj.cms.push(cmObj);\n            }\n        });\n        allCmsPerTopic.push(topicObj);\n    });\n};"],"names":["IDENTIFIERS","allCmsPerTopic","resultsHolder","resultsCount","searchClearBtn","searchInput","search","searchValue","showAll","length","resultscount","forEach","topic","foundInTopic","cms","cm","title","indexOf","visible","elem","classList","remove","add","textContent","searchClear","e","preventDefault","value","submitForm","checkbox","checked","document","getElementById","addEventListener","target","toLowerCase","form","querySelector","topics","querySelectorAll","elements","topicObj","element","cmObj","push"],"mappings":"wJAAMA,wBACW,8BADXA,iBAEI,0BAFJA,yBAGY,SAHZA,mBAIM,cAJNA,qBAKQ,yBALRA,kBAMK,oCANLA,0BAOa,gCAPbA,yBAQY,sCARZA,wBASW,+BAGXC,eAAiB,OACnBC,cAAgB,KAChBC,aAAe,KACfC,eAAiB,KACjBC,YAAc,WAGZC,OAAUC,oBACNC,QAAiC,IAAvBD,YAAYE,WACxBC,aAAe,EACnBT,eAAeU,SAAQC,YACfC,cAAe,EACnBD,MAAME,IAAIH,SAAQI,KACVA,GAAGC,MAAMC,QAAQV,cAAgB,GAAKC,SACtCK,cAAe,EACfH,eACAK,GAAGG,SAAU,EACbH,GAAGI,KAAKC,UAAUC,OAAO,YAEzBN,GAAGG,SAAU,EACbH,GAAGI,KAAKC,UAAUE,IAAI,cAG1BT,cACAD,MAAMM,SAAU,EAChBN,MAAMO,KAAKC,UAAUC,OAAO,YAE5BT,MAAMM,SAAU,EAChBN,MAAMO,KAAKC,UAAUE,IAAI,cAG5Bd,SAKDN,cAAckB,UAAUE,IAAI,UAC5BlB,eAAegB,UAAUE,IAAI,YAL7BnB,aAAaoB,YAAcb,aAC3BR,cAAckB,UAAUC,OAAO,UAC/BjB,eAAegB,UAAUC,OAAO,YAOlCG,YAAeC,IACjBA,EAAEC,iBACFrB,YAAYsB,MAAQ,GACpBrB,OAAO,KAGLsB,WAAa,KAEf3B,eAAeU,SAAQC,SACdA,MAAMM,SAAWN,MAAMiB,SAASC,UACjClB,MAAMiB,SAASC,SAAU,GAE7BlB,MAAME,IAAIH,SAAQI,MACTA,GAAGG,SAAWH,GAAGc,SAASC,UAC3Bf,GAAGc,SAASC,SAAU,UAI3B,iBAGS,KAChBzB,YAAc0B,SAASC,eAAehC,yBACtCK,YAAY4B,iBAAiB,SAAUR,IAAQnB,OAAOmB,EAAES,OAAOP,MAAMQ,wBAC/DC,KAAOL,SAASM,cAAcrC,kBAC9BsC,OAASF,KAAKG,iBAAiBvC,oBACrCE,cAAgB6B,SAASC,eAAehC,2BACxCG,aAAe4B,SAASC,eAAehC,0BACvCI,eAAiB2B,SAASM,cAAcrC,yBACxCI,eAAe6B,iBAAiB,QAAST,aAEzCY,KAAKH,iBAAiB,SAAUL,YAChCU,OAAO3B,SAAQC,cACL4B,SAAW5B,MAAM2B,iBAAiBvC,0BAClCyC,SAAW,GACjBA,SAAStB,KAAOP,MAChB6B,SAAS3B,IAAM,GACf2B,SAASvB,SAAU,EACnBuB,SAASZ,SAAWjB,MAAMyB,cAAcrC,sBACxCwC,SAAS7B,SAAQ+B,gBACP1B,MAAQ0B,QAAQL,cAAcrC,sBAChCgB,MAAO,OACD2B,MAAQ,GACdA,MAAM3B,MAAQA,MAAMO,YAAYY,cAChCQ,MAAMxB,KAAOuB,QACbC,MAAMzB,SAAU,EAChByB,MAAMd,SAAWa,QAAQL,cAAcrC,sBACvCyC,SAAS3B,IAAI8B,KAAKD,WAG1B1C,eAAe2C,KAAKH"}