{"version":3,"file":"search.min.js","sources":["../src/search.js"],"sourcesContent":["const IDENTIFIERS = {\n    SEARCHINPUT: 'downloadcenter-search-input',\n    FORM: '#region-main form.mform',\n    FORMELEMENTS: '.fitem',\n    TOPICS: '.card.block',\n    CHECKBOX: 'input[type=\"checkbox\"]',\n    TITLE: 'label .itemtitle span:not(.badge)',\n    RESULTSHOLDER: 'downloadcenter-search-results',\n    RESULTSCOUNT: 'downloadcenter-search-results-count',\n    SEARCHCLEAR: '#downloadcenter-search-clear'\n};\n\nconst allCmsPerTopic = [];\nlet resultsHolder = null;\nlet resultsCount = null;\nlet searchClearBtn = null;\nlet searchInput = null;\n\n\nconst search = (searchValue) => {\n    const showAll = searchValue.length === 0;\n    let resultscount = 0;\n    allCmsPerTopic.forEach(topic => {\n        let foundInTopic = false;\n        topic.cms.forEach(cm => {\n            if (cm.title.indexOf(searchValue) > -1 || showAll) {\n                foundInTopic = true;\n                resultscount++;\n                cm.visible = true;\n                cm.elem.classList.remove('d-none');\n            } else {\n                cm.visible = false;\n                cm.elem.classList.add('d-none');\n            }\n        });\n        if (foundInTopic) {\n            topic.visible = true;\n            topic.elem.classList.remove('d-none');\n        } else {\n            topic.visible = false;\n            topic.elem.classList.add('d-none');\n        }\n    });\n    if (!showAll) {\n        resultsCount.textContent = resultscount;\n        resultsHolder.classList.remove('d-none');\n        searchClearBtn.classList.remove('d-none');\n    } else {\n        resultsHolder.classList.add('d-none');\n        searchClearBtn.classList.add('d-none');\n    }\n};\n\nconst searchClear = (e) => {\n    e.preventDefault();\n    searchInput.value = '';\n    search('');\n};\n\nconst submitForm = () => {\n    // We need to make sure that if a topic or a cm is not visible, it's checkbox is not checked.\n    allCmsPerTopic.forEach(topic => {\n        if (!topic.visible && topic.checkbox.checked) {\n            topic.checkbox.checked = false;\n        }\n        topic.cms.forEach(cm => {\n            if (!cm.visible && cm.checkbox.checked) {\n                cm.checkbox.checked = false;\n            }\n        });\n    });\n    return true;\n};\n\nexport const init = () => {\n    searchInput = document.getElementById(IDENTIFIERS.SEARCHINPUT);\n    searchInput.addEventListener('input', (e) => { search(e.target.value.toLowerCase()); });\n    const form = document.querySelector(IDENTIFIERS.FORM);\n    const topics = form.querySelectorAll(IDENTIFIERS.TOPICS);\n    resultsHolder = document.getElementById(IDENTIFIERS.RESULTSHOLDER);\n    resultsCount = document.getElementById(IDENTIFIERS.RESULTSCOUNT);\n    searchClearBtn = document.querySelector(IDENTIFIERS.SEARCHCLEAR);\n    searchClearBtn.addEventListener('click', searchClear);\n\n    form.addEventListener('submit', submitForm);\n    topics.forEach(topic => {\n        const elements = topic.querySelectorAll(IDENTIFIERS.FORMELEMENTS);\n        const topicObj = {};\n        topicObj.elem = topic;\n        topicObj.cms = [];\n        topicObj.visible = true;\n        topicObj.checkbox = topic.querySelector(IDENTIFIERS.CHECKBOX);\n        elements.forEach(element => {\n            const title = element.querySelector(IDENTIFIERS.TITLE);\n            if (title) {\n                const cmObj = {};\n                cmObj.title = title.textContent.toLowerCase();\n                cmObj.elem = element;\n                cmObj.visible = true;\n                cmObj.checkbox = element.querySelector(IDENTIFIERS.CHECKBOX);\n                topicObj.cms.push(cmObj);\n            }\n        });\n        allCmsPerTopic.push(topicObj);\n    });\n};"],"names":["IDENTIFIERS","allCmsPerTopic","resultsHolder","resultsCount","searchClearBtn","searchInput","search","searchValue","showAll","length","resultscount","forEach","topic","foundInTopic","cms","cm","title","indexOf","visible","elem","classList","remove","add","textContent","searchClear","e","preventDefault","value","submitForm","checkbox","checked","_exports","init","document","getElementById","addEventListener","target","toLowerCase","form","querySelector","topics","querySelectorAll","elements","topicObj","element","cmObj","push"],"mappings":"kJAAA,MAAMA,wBACW,8BADXA,iBAEI,0BAFJA,yBAGY,SAHZA,mBAIM,cAJNA,qBAKQ,yBALRA,kBAMK,oCANLA,0BAOa,gCAPbA,yBAQY,sCARZA,wBASW,+BAGXC,eAAiB,GACvB,IAAIC,cAAgB,KAChBC,aAAe,KACfC,eAAiB,KACjBC,YAAc,KAGlB,MAAMC,OAAUC,cACZ,MAAMC,QAAiC,IAAvBD,YAAYE,OAC5B,IAAIC,aAAe,EACnBT,eAAeU,SAAQC,QACnB,IAAIC,cAAe,EACnBD,MAAME,IAAIH,SAAQI,KACVA,GAAGC,MAAMC,QAAQV,cAAgB,GAAKC,SACtCK,cAAe,EACfH,eACAK,GAAGG,SAAU,EACbH,GAAGI,KAAKC,UAAUC,OAAO,YAEzBN,GAAGG,SAAU,EACbH,GAAGI,KAAKC,UAAUE,IAAI,UAC1B,IAEAT,cACAD,MAAMM,SAAU,EAChBN,MAAMO,KAAKC,UAAUC,OAAO,YAE5BT,MAAMM,SAAU,EAChBN,MAAMO,KAAKC,UAAUE,IAAI,UAC7B,IAECd,SAKDN,cAAckB,UAAUE,IAAI,UAC5BlB,eAAegB,UAAUE,IAAI,YAL7BnB,aAAaoB,YAAcb,aAC3BR,cAAckB,UAAUC,OAAO,UAC/BjB,eAAegB,UAAUC,OAAO,UAIpC,EAGEG,YAAeC,IACjBA,EAAEC,iBACFrB,YAAYsB,MAAQ,GACpBrB,OAAO,GAAG,EAGRsB,WAAaA,KAEf3B,eAAeU,SAAQC,SACdA,MAAMM,SAAWN,MAAMiB,SAASC,UACjClB,MAAMiB,SAASC,SAAU,GAE7BlB,MAAME,IAAIH,SAAQI,MACTA,GAAGG,SAAWH,GAAGc,SAASC,UAC3Bf,GAAGc,SAASC,SAAU,EAC1B,GACF,KAEC,GAkCTC,SAAAC,KA/BkBA,KAChB3B,YAAc4B,SAASC,eAAelC,yBACtCK,YAAY8B,iBAAiB,SAAUV,IAAQnB,OAAOmB,EAAEW,OAAOT,MAAMU,cAAc,IACnF,MAAMC,KAAOL,SAASM,cAAcvC,kBAC9BwC,OAASF,KAAKG,iBAAiBzC,oBACrCE,cAAgB+B,SAASC,eAAelC,2BACxCG,aAAe8B,SAASC,eAAelC,0BACvCI,eAAiB6B,SAASM,cAAcvC,yBACxCI,eAAe+B,iBAAiB,QAASX,aAEzCc,KAAKH,iBAAiB,SAAUP,YAChCY,OAAO7B,SAAQC,QACX,MAAM8B,SAAW9B,MAAM6B,iBAAiBzC,0BAClC2C,SAAW,CAAA,EACjBA,SAASxB,KAAOP,MAChB+B,SAAS7B,IAAM,GACf6B,SAASzB,SAAU,EACnByB,SAASd,SAAWjB,MAAM2B,cAAcvC,sBACxC0C,SAAS/B,SAAQiC,UACb,MAAM5B,MAAQ4B,QAAQL,cAAcvC,mBACpC,GAAIgB,MAAO,CACP,MAAM6B,MAAQ,CAAA,EACdA,MAAM7B,MAAQA,MAAMO,YAAYc,cAChCQ,MAAM1B,KAAOyB,QACbC,MAAM3B,SAAU,EAChB2B,MAAMhB,SAAWe,QAAQL,cAAcvC,sBACvC2C,SAAS7B,IAAIgC,KAAKD,MACtB,KAEJ5C,eAAe6C,KAAKH,SAAS,GAC/B,CACJ"}