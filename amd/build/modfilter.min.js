define ("local_downloadcenter/modfilter",["jquery","core/str","core/url"],function(a,b,c){var d=function(d){var f=this;this.modnames=d;this.strings={};this.formid=null;this.currentlyshown=!1;this.modlist=null;b.get_strings([{key:"all",component:"moodle"},{key:"none",component:"moodle"},{key:"select",component:"moodle"},{key:"showtypes",component:"backup"},{key:"hidetypes",component:"backup"}]).done(function(b){f.strings.all=b[0];f.strings.none=b[1];f.strings.select=b[2];f.strings.showtypes=b[3];f.strings.hidetypes=b[4];var d=a("div[role=\"main\"] > form .card.block").first();f.formid=d.closest("form").prop("id");var e=f.html_generator("included",f.strings.select);e+=f.row_generator("(<a id=\"downloadcenter-bytype\" href=\"#\">"+f.strings.showtypes+"</a>)","");var g=a(document.createElement("div"));g.addClass("grouped_settings section_level block card");g.html(e);g.insertBefore(d);f.modlist=a(document.createElement("div"));f.modlist.prop("id","mod_select_links");f.modlist.prop("class","m-l-2");f.modlist.appendTo(g);f.modlist.hide();for(var h in f.modnames){if(!f.modnames.hasOwnProperty(h)){continue}var i="<img src=\""+c.imageUrl("icon","mod_"+h)+"\" class=\"activityicon\" />";e=f.html_generator("mod_"+h,i+f.modnames[h]);var j=a(document.createElement("div"));j.addClass("grouped_settings section_level");j.html(e);j.appendTo(f.modlist);f.initlinks(j,h)}a("#downloadcenter-all-included").click(function(a){f.helper(a,!0,"item_")});a("#downloadcenter-none-included").click(function(a){f.helper(a,!1,"item_")});a("#downloadcenter-bytype").click(function(a){a.preventDefault();f.toggletypes()});a("input.form-check-input").click(function(){f.checkboxhandler(a(this));f.updateFormState()})})};d.prototype.checkboxhandler=function(a){var b="item_",c=a.prop("name"),d=a.prop("checked");if(c.substring(0,b.length)===b){var e=a.parentsUntil("form",".card");if(c.substring(0,"item_topic".length)==="item_topic"){e.find("input.form-check-input").prop("checked",d)}else{if(d){e.find("input.form-check-input[name^=\"item_topic\"]").prop("checked",!0)}}}};d.prototype.updateFormState=function(){if(this.formid&&M.form&&M.form.updateFormState){M.form.updateFormState(this.formid)}};d.prototype.toggletypes=function(){var b=a("#downloadcenter-bytype");if(this.currentlyshown){b.text(this.strings.showtypes)}else{b.text(this.strings.hidetypes)}this.modlist.animate({height:"toggle"},500,"swing");this.currentlyshown=!this.currentlyshown};d.prototype.initlinks=function(b,c){var d=this;a("#downloadcenter-all-mod_"+c).click(function(a){d.helper(a,!0,"item_",c)});a("#downloadcenter-none-mod_"+c).click(function(a){d.helper(a,!1,"item_",c)})};d.prototype.helper=function(b,c,d,e){b.preventDefault();var f="";if("undefined"!=typeof e){f="item_"+e+"_"}var g=d.length;a("input[type=\"checkbox\"]").each(function(b,e){e=a(e);var h=e.prop("name");if(f&&h.substring(0,f.length)!==f){return}if(h.substring(0,g)===d){e.prop("checked",c)}if(c){e.closest(".card.block").find(".form-group:first-child input").prop("checked",c)}});this.updateFormState()};d.prototype.html_generator=function(a,b){var c="<a id=\"downloadcenter-all-"+a+"\" href=\"#\">"+this.strings.all+"</a> / ";c+="<a id=\"downloadcenter-none-"+a+"\" href=\"#\">"+this.strings.none+"</a>";return this.row_generator(b,c)};d.prototype.row_generator=function(a,b){var c="<div class=\"form-group row fitem downloadcenter_selector\">";c+="<div class=\"col-md-3\"></div>";c+="<div class=\"col-md-9\">";c+="<label><span class=\"itemtitle\">"+a+"</span></label>";c+="<span class=\"text-nowrap\">"+b+"</span>";c+="</div>";c+="</div>";return c};return{init:function init(a){return new d(a)}}});
//# sourceMappingURL=modfilter.min.js.map
