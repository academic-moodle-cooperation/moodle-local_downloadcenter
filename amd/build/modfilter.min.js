define(["jquery","core/str","core/url"],function(a,b,c){var d,e,f,g={},h=!1,i=function(h){d=h,b.get_strings([{key:"all",component:"moodle"},{key:"none",component:"moodle"},{key:"select",component:"moodle"},{key:"showtypes",component:"backup"},{key:"hidetypes",component:"backup"}]).done(function(b){g.all=b[0],g.none=b[1],g.select=b[2],g.showtypes=b[3],g.hidetypes=b[4];var h=a("#mform1 .card.block").first();e=h.closest("form").prop("id");var i=m("included",g.select);i+=n('(<a id="downloadcenter-bytype" href="#">'+g.showtypes+"</a>)","");var o=a(document.createElement("div"));o.addClass("grouped_settings section_level block card"),o.html(i),o.insertBefore(h),f=a(document.createElement("div")),f.prop("id","mod_select_links"),f.prop("class","m-l-2"),f.appendTo(o),f.hide();for(var p in d)if(d.hasOwnProperty(p)){var q='<img src="'+c.imageUrl("icon","mod_"+p)+'" class="activityicon" />';i=m("mod_"+p,q+d[p]);var r=a(document.createElement("div"));r.addClass("grouped_settings section_level"),r.html(i),r.appendTo(f),k(r,p)}a("#downloadcenter-all-included").click(function(a){l(a,!0,"item_")}),a("#downloadcenter-none-included").click(function(a){l(a,!1,"item_")}),a("#downloadcenter-bytype").click(function(){j()})})},j=function(){var b=a("#downloadcenter-bytype");h?b.text(g.showtypes):b.text(g.hidetypes),f.animate({height:"toggle"},500,"swing"),h=!h},k=function(b,c){a("#downloadcenter-all-mod_"+c).click(function(a){l(a,!0,"item_",c)}),a("#downloadcenter-none-mod_"+c).click(function(a){l(a,!1,"item_",c)})},l=function(b,c,d,f){b.preventDefault();var g="";"undefined"!=typeof f&&(g="item_"+f+"_");var h=d.length;a('input[type="checkbox"]').each(function(b,e){e=a(e);var f=e.prop("name");g&&f.substring(0,g.length)!==g||f.substring(0,h)===d&&e.prop("checked",c)}),e&&M.form&&M.form.updateFormState(e)},m=function(a,b){var c='<a id="downloadcenter-all-'+a+'" href="#">'+g.all+"</a> / ";return c+='<a id="downloadcenter-none-'+a+'" href="#">'+g.none+"</a>",n(b,c)},n=function(a,b){var c='<div class="form-group row fitem downloadcenter_selector">';return c+='<div class="col-md-3"></div>',c+='<div class="col-md-9">',c+='<label><span class="itemtitle">'+a+"</span></label>",c+='<span class="text-nowrap">'+b+"</span>",c+="</div>",c+="</div>"};return{init:function(a){return new i(a)}}});